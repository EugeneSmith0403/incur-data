# Рефакторинг типов tx-parsing

## Дата: 2026-01-28

## Изменения

### Консолидация типов

Все типы модуля теперь собраны в единый файл `src/types.ts` для улучшения поддерживаемости и избежания дублирования.

### Структура типов

#### `src/types.ts`
Содержит все типы модуля:

**Instruction Types:**
- `DLNInstructionType` - enum для типов инструкций DLN
- `ParsedDLNInstruction` - интерфейс разобранной инструкции
- `CreateOrderData` - данные инструкции создания ордера
- `FulfillOrderData` - данные инструкции выполнения ордера
- `CancelOrderData` - данные инструкции отмены ордера
- `ClaimOrderData` - данные инструкции клейма ордера

**Event Types:**
- `DlnEventType` - enum для типов событий DLN
- `ParsedDlnEvent` - интерфейс разобранного события
- `OrderCreatedData` - данные события создания ордера
- `OrderFulfilledData` - данные события выполнения ордера

**Parser Types:**
- `ParsedTransaction` - результат парсинга транзакции
- `ParserConfig` - конфигурация парсера

### Экспорты

#### `src/index.ts`
Главная точка входа экспортирует:
- Все типы из `types.ts`
- Классы и функции парсеров
- Утилитарные функции

#### `src/dln-event-parser.ts`
Реэкспортирует связанные с событиями типы для удобства:
- `DlnEventType`
- `ParsedDlnEvent`
- `OrderCreatedData`
- `OrderFulfilledData`

### Обратная совместимость

Все существующие импорты продолжают работать:

```typescript
// Импорт из главной точки входа
import { DlnEventType, ParsedDlnEvent } from '@incur-data/tx-parsing';

// Импорт из конкретного модуля (по-прежнему работает)
import { DlnEventType } from '@incur-data/tx-parsing/dln-event-parser';

// Импорт напрямую из types
import { DlnEventType } from '@incur-data/tx-parsing/types';
```

### Преимущества рефакторинга

1. **Единый источник истины** - все типы в одном месте
2. **Избежание дублирования** - типы определены один раз
3. **Улучшенная поддерживаемость** - легче найти и обновить типы
4. **Лучшая организация кода** - четкое разделение типов и логики
5. **Обратная совместимость** - существующий код продолжает работать

### Файлы, затронутые рефакторингом

- ✅ `src/types.ts` - обновлен, добавлены типы из других файлов
- ✅ `src/dln-event-parser.ts` - удалены дублирующие типы, добавлены импорты
- ✅ `src/index.ts` - обновлены экспорты
- ✅ Все тесты продолжают работать
- ✅ Компиляция успешна
- ✅ Линтер не выдает ошибок

### Тестирование

```bash
# Компиляция
pnpm build  # ✅ Success

# Линтер
# ✅ No linter errors

# Тесты (существующие падения не связаны с рефакторингом)
pnpm test
```

### Рекомендации для дальнейшего использования

При добавлении новых типов:
1. Добавляйте их в `src/types.ts`
2. Экспортируйте через `src/index.ts`
3. При необходимости реэкспортируйте из специфичных модулей для удобства
